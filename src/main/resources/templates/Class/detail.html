<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{top::menu}"></div>

<body>
<div id="Left-container">
  <div id="imgcontainer">
    <img th:src="@{/image/}+${dto.cmimage}">
  </div>
  </div>

<div id="Right-contianer">
  <div id="ctitle">
    <a th:text="${dto.cname}"></a>
  </div>
<div id="cprice">
  <a th:text="${dto.cprice}"></a>
</div>
  <div id="ctime">
  <a th:text="${dto.ctime}"></a>
</div>
</div>

<div id="detail-container">
<div id="detail-image">
  <img th:src="@{/image/}+${dto.cdimage}">
</div>
<div id="detail-text">
  <a th:text="${dto.cdtext}"></a>
</div>
</div>

<div id="map-container">

</div>

<div id="review-container">
  <form th:action="@{'/detail/review?num=' + ${dto.cnum}}" method="post" th:object="${review}" enctype="multipart/form-data">
    <div>
      <label for="title">제목:</label>
      <input type="text" id="title" th:field="*{title}" required>
    </div>
    <div>
      <label for="contents">내용:</label>
      <textarea id="contents" th:field="*{contents}" required></textarea>
    </div>
    <div>
      <label for="image1">이미지:</label>
      <input type="file" id="image1" th:field="*{image1}" required>
    </div>
    <div>
      <label for="revstar">평점:</label>
      <input type="number" id="revstar" th:field="*{revstar}" min="0" max="5" required>
      <input type="hidden" id="cnum" name="cnum" th:value="${dto.cnum}">
    </div>
    <button type="submit">리뷰 등록</button>
  </form>
</div>

<h3>리뷰 목록</h3>
<div th:if="${reviews.isEmpty()}">
  <p>등록된 리뷰가 없습니다.</p>
</div>
<div th:each="review : ${reviews}">
  <h4 th:text="${review.title}">리뷰 제목</h4>
  <p th:text="${review.contents}">리뷰 내용</p>
  <p><img th:src="@{/image/}+${review.image1}"></p>
  <p>평점: <span th:text="${review.revstar}">0</span></p>
  <p>작성자: <span th:text="${review.nickname}">닉네임</span></p>
  <p><small th:text="${review.revdate}">작성 날짜</small></p>
  <p th:text="${review.revnum}">리뷰번호</p>
  <!-- 댓글 작성 폼 -->
  <form th:action="@{/reviews/{revnum}/comment(revnum=${review.revnum})}" method="post">
    <input type="text" name="id" th:value="${id}" />
    <input type="hidden" name="revnum" th:value="${review.revnum}">
    <input type="hidden" id="cnum" name="cnum" th:value="${dto.cnum}">
    <textarea name="comcontents" placeholder="답글 내용" required></textarea>
    <button type="submit">댓글 작성</button>
  </form>
</div>

<h3>댓글 목록</h3>
<div th:each="comment : ${comments}">
  <p><strong th:text="${comment.id}">작성자</strong>:</p>
  <p th:text="${comment.comcontents}">내용</p>
  <p><small th:text="${comment.comdate}">작성 날짜</small></p>
</div>

</body>
</html>